<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<!-- Title -->
<title>2016:编写高性能的 JavaScript - WEB前端 - 伯乐在线</title>
<link rel="stylesheet" id="crayon_style-css" href="css/crayon_style.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-github-css" href="css/github.css" type="text/css" media="all">
<!-- END head -->
</head>
<div class="entry">
<p>本文的初衷是想介绍如何利用些简单的代码小技巧就能促进JavaScript编译器的优化进程从而提升代码运行效率。特别是在游戏这种对于垃圾回收速度要求较高，你性能稍微差点用户就能见到白屏的地方。</p>
<h1 id="articleHeader0">Monomorphism:单态性</h1>
<p>JavaScript中允许函数调用时候传入动态参数，不过就以简单的2参数函数为例，当你的参数类型、参数数目与返回类型动态调用时才能决定，编译器需要更多的时间来解析。编译器自然地希望能够处理那些单态可预测的数据结构、参数统计等。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div id="crayon-5843708794a86576664247" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important; height: auto;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 15px !important; z-index: 0; opacity: 0;">function example(a, b) {
  // we expect a, b to be numeric
  console.log(++a * ++b);
};

example(); // bad
example(1); // still bad
example("1", 2); // dammit meg

example(1, 2); // good</textarea></div>
<div class="crayon-main" style="position: relative; z-index: 1;">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5843708794a86576664247-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a86576664247-2">2</div><div class="crayon-num" data-line="crayon-5843708794a86576664247-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a86576664247-4">4</div><div class="crayon-num" data-line="crayon-5843708794a86576664247-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a86576664247-6">6</div><div class="crayon-num" data-line="crayon-5843708794a86576664247-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a86576664247-8">8</div><div class="crayon-num" data-line="crayon-5843708794a86576664247-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a86576664247-10">10</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5843708794a86576664247-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">example</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a86576664247-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// we expect a, b to be numeric</span></div><div class="crayon-line" id="crayon-5843708794a86576664247-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">console</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-o">++</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">++</span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a86576664247-4"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794a86576664247-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a86576664247-6"><span class="crayon-e">example</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// bad</span></div><div class="crayon-line" id="crayon-5843708794a86576664247-7"><span class="crayon-e">example</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// still bad</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a86576664247-8"><span class="crayon-e">example</span><span class="crayon-sy">(</span><span class="crayon-s">"1"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// dammit meg</span></div><div class="crayon-line" id="crayon-5843708794a86576664247-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a86576664247-10"><span class="crayon-e">example</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// good</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
<!-- [Format Time: 0.0013 seconds] -->
<p></p>
<h1 id="articleHeader1">Constants:常量</h1>
<p>使用常量能够让编译器在编译时即完成变量的值替换:</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div id="crayon-5843708794a90411494267" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important; height: auto;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 15px !important; z-index: 0; opacity: 0;">const a = 42; // we can easily unfold this
const b = 1337 * 2; // we can resolve this expression
const c = a + b; // still can be resolved
const d = Math.random() * c; // we can only unfold 'c'

// before unfolding
a;
b;
c;
d;

// after unfolding
// we can do this at compile time!
42;
2674;
2716;
Math.random() * 2716;</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5843708794a90411494267-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a90411494267-2">2</div><div class="crayon-num" data-line="crayon-5843708794a90411494267-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a90411494267-4">4</div><div class="crayon-num" data-line="crayon-5843708794a90411494267-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a90411494267-6">6</div><div class="crayon-num" data-line="crayon-5843708794a90411494267-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a90411494267-8">8</div><div class="crayon-num" data-line="crayon-5843708794a90411494267-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a90411494267-10">10</div><div class="crayon-num" data-line="crayon-5843708794a90411494267-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a90411494267-12">12</div><div class="crayon-num" data-line="crayon-5843708794a90411494267-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a90411494267-14">14</div><div class="crayon-num" data-line="crayon-5843708794a90411494267-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a90411494267-16">16</div><div class="crayon-num" data-line="crayon-5843708794a90411494267-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5843708794a90411494267-1"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// we can easily unfold this</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a90411494267-2"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1337</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// we can resolve this expression</span></div><div class="crayon-line" id="crayon-5843708794a90411494267-3"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// still can be resolved</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a90411494267-4"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">d</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Math</span><span class="crayon-sy">.</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// we can only unfold 'c'</span></div><div class="crayon-line" id="crayon-5843708794a90411494267-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a90411494267-6"><span class="crayon-c">// before unfolding</span></div><div class="crayon-line" id="crayon-5843708794a90411494267-7"><span class="crayon-v">a</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a90411494267-8"><span class="crayon-v">b</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794a90411494267-9"><span class="crayon-v">c</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a90411494267-10"><span class="crayon-v">d</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794a90411494267-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a90411494267-12"><span class="crayon-c">// after unfolding</span></div><div class="crayon-line" id="crayon-5843708794a90411494267-13"><span class="crayon-c">// we can do this at compile time!</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a90411494267-14"><span class="crayon-cn">42</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794a90411494267-15"><span class="crayon-cn">2674</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a90411494267-16"><span class="crayon-cn">2716</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794a90411494267-17"><span class="crayon-v">Math</span><span class="crayon-sy">.</span><span class="crayon-e">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2716</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p></p>
<h1 id="articleHeader2">Inlining:内联</h1>
<p>JIT编译器能够找出你的代码中被执行次数最多的部分，将你的代码分割成多个小的代码块能够有助于编译器在编译时将这些代码块转化为内联格式然后增加执行速度。</p>
<h1 id="articleHeader3">Data Types:数据类型</h1>
<p>尽可能地多用Numbers与Booleans类型，因为他们与其他类似于字符串等原始类型相比性能表现更好。使用字符串类型可能会带来额外的垃圾回收消耗。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5843708794a94541720658" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 15px !important; z-index: 0; opacity: 0;">const ROBOT = 0;
const HUMAN = 1;
const SPIDER = 2;

let E_TYPE = {
  Robot: ROBOT,
  Human: HUMAN,
  Spider: SPIDER
};

// bad
// avoid uncached strings in heavy tasks (or better in general)
if (entity.type === "Robot") {
  
}

// good
// the compiler can resolve member expressions
// without much deepness pretty fast
if (entity.type === E_TYPE.Robot) {
  
}

// perfect
// right side of binary expression can even get unfold
if (entity.type === ROBOT) {
  
}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5843708794a94541720658-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-2">2</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-4">4</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-6">6</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-8">8</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-10">10</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-12">12</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-14">14</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-16">16</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-18">18</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-20">20</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-22">22</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-24">24</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-26">26</div><div class="crayon-num" data-line="crayon-5843708794a94541720658-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794a94541720658-28">28</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5843708794a94541720658-1"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">ROBOT</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-2"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">HUMAN</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794a94541720658-3"><span class="crayon-m">const</span><span class="crayon-h"> </span><span class="crayon-v">SPIDER</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-4">&nbsp;</div><div class="crayon-line" id="crayon-5843708794a94541720658-5"><span class="crayon-e">let </span><span class="crayon-v">E_TYPE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Robot</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">ROBOT</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5843708794a94541720658-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Human</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">HUMAN</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Spider</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">SPIDER</span></div><div class="crayon-line" id="crayon-5843708794a94541720658-9"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-10">&nbsp;</div><div class="crayon-line" id="crayon-5843708794a94541720658-11"><span class="crayon-c">// bad</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-12"><span class="crayon-c">// avoid uncached strings in heavy tasks (or better in general)</span></div><div class="crayon-line" id="crayon-5843708794a94541720658-13"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">entity</span><span class="crayon-sy">.</span><span class="crayon-v">type</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-s">"Robot"</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-14"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5843708794a94541720658-15"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-16">&nbsp;</div><div class="crayon-line" id="crayon-5843708794a94541720658-17"><span class="crayon-c">// good</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-18"><span class="crayon-c">// the compiler can resolve member expressions</span></div><div class="crayon-line" id="crayon-5843708794a94541720658-19"><span class="crayon-c">// without much deepness pretty fast</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-20"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">entity</span><span class="crayon-sy">.</span><span class="crayon-v">type</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-v">E_TYPE</span><span class="crayon-sy">.</span><span class="crayon-v">Robot</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5843708794a94541720658-21"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-22"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5843708794a94541720658-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-24"><span class="crayon-c">// perfect</span></div><div class="crayon-line" id="crayon-5843708794a94541720658-25"><span class="crayon-c">// right side of binary expression can even get unfold</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-26"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">entity</span><span class="crayon-sy">.</span><span class="crayon-v">type</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-v">ROBOT</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5843708794a94541720658-27"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794a94541720658-28"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0023 seconds] -->
<p></p>
<h1 id="articleHeader4">Strict &amp; Abstract Operators</h1>
<p>尽可能使用<code>===</code>这个严格比较操作符而不是<code>==</code>操作符。使用严格比较操作符能够避免编译器进行类型推导与转换，从而提高一定的性能。</p>
<h1 id="articleHeader5">Strict Conditions</h1>
<p>JavaScript中的if语句也非常灵活，你可以直接在<code>if(a) then bla</code>这个类型的条件选择语句中传入随意类似的a值。不过这种情况下，就像上文提及的严格比较操作符与宽松比较操作符一样，编译器需要将其转化为多个数据类型进行比较，而不能立刻得出结果。当然，这并不是一味的反对使用简写方式，而是在非常强调性能的场景，还是建议做好每一个细节的优化:</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5843708794aaa822040687" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 15px !important; z-index: 0; opacity: 0;">let a = 2;

// bad
// abstracts to check in the worst case:
// - is value equal to true
// - is value greater than zero
// - is value not null
// - is value not NaN
// ..
if (a) {
 // if a is true, do something 
}

// good
if (a === 2) {
  // do sth 
}

// same goes for functions
function b() {
  return (!false);
};

if (b()) {
  // get in here slow
}

if (b() === true) {
  // get in here fast
  // the compiler knows a specific value to compare with
}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5843708794aaa822040687-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-2">2</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-4">4</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-6">6</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-8">8</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-10">10</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-12">12</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-14">14</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-16">16</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-18">18</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-20">20</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-22">22</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-24">24</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-26">26</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-28">28</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aaa822040687-30">30</div><div class="crayon-num" data-line="crayon-5843708794aaa822040687-31">31</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5843708794aaa822040687-1"><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-2">&nbsp;</div><div class="crayon-line" id="crayon-5843708794aaa822040687-3"><span class="crayon-c">// bad</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-4"><span class="crayon-c">// abstracts to check in the worst case:</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-5"><span class="crayon-c">// - is value equal to true</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-6"><span class="crayon-c">// - is value greater than zero</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-7"><span class="crayon-c">// - is value not null</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-8"><span class="crayon-c">// - is value not NaN</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-9"><span class="crayon-c">// ..</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-10"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-11"><span class="crayon-h"> </span><span class="crayon-c">// if a is true, do something </span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-12"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-14"><span class="crayon-c">// good</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-15"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// do sth </span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-17"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-18">&nbsp;</div><div class="crayon-line" id="crayon-5843708794aaa822040687-19"><span class="crayon-c">// same goes for functions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-20"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">b</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-t">false</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-22"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-24"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">b</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// get in here slow</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-26"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-28"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">b</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-29"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// get in here fast</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aaa822040687-30"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// the compiler knows a specific value to compare with</span></div><div class="crayon-line" id="crayon-5843708794aaa822040687-31"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p></p>
<h1 id="articleHeader6">Arguments</h1>
<p>尽可能避免使用arguments[index]方式进行参数获取，并且尽量避免修改传入的参数变量:</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5843708794aae469967447" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 15px !important; z-index: 0; opacity: 0;">function mul(a, b) {
  return (arguments[0]*arguments[1]); // bad, very slow
  return (a*b); // good
};

function test(a, b) {
  a = 5; // bad, dont modify argument identifiers
  let tmp = a; // good
  tmp *= 2; // we can now modify our fake 'a'
};</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5843708794aae469967447-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aae469967447-2">2</div><div class="crayon-num" data-line="crayon-5843708794aae469967447-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aae469967447-4">4</div><div class="crayon-num" data-line="crayon-5843708794aae469967447-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aae469967447-6">6</div><div class="crayon-num" data-line="crayon-5843708794aae469967447-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aae469967447-8">8</div><div class="crayon-num" data-line="crayon-5843708794aae469967447-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794aae469967447-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5843708794aae469967447-1"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">mul</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aae469967447-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">arguments</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-o">*</span><span class="crayon-r">arguments</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// bad, very slow</span></div><div class="crayon-line" id="crayon-5843708794aae469967447-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-o">*</span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// good</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aae469967447-4"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794aae469967447-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aae469967447-6"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">test</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5843708794aae469967447-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// bad, dont modify argument identifiers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aae469967447-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">let </span><span class="crayon-v">tmp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">a</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// good</span></div><div class="crayon-line" id="crayon-5843708794aae469967447-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">tmp</span><span class="crayon-h"> </span><span class="crayon-o">*=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// we can now modify our fake 'a'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794aae469967447-10"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p></p>
<h1 id="articleHeader7">Toxicity:这些关键字有毒</h1>
<h1 id="articleHeader8">Toxicity</h1>
<p>如下列举的几个语法特性会影响优化进程:</p>
<ul>
<li>eval</li>
<li>with</li>
<li>try/catch</li>
</ul>
<p>同时尽量避免在函数内声明函数或者闭包，可能在大量的运算中导致过多的垃圾回收操作。</p>
<h1 id="articleHeader9">Objecs</h1>
<p>Object实例通常会共享隐类，因此当我们访问或者设置某个实例的未预定义变量值的时候会创建一个隐类。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5843708794ab2421181043" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 15px !important; z-index: 0; opacity: 0;">// our hidden class 'hc_0'
class Vector {
  constructor(x, y) {
    // compiler finds and expects member declarations here
    this.x = x;
    this.y = y;
  }
};

// both vector objects share hidden class 'hc_0'
let vec1 = new Vector(0, 0);
let vec2 = new Vector(2, 2);

// bad, vec2 got hidden class 'hc_1' now
vec2.z = 0;

// good, compiler knows this member
vec2.x = 1;</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5843708794ab2421181043-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab2421181043-2">2</div><div class="crayon-num" data-line="crayon-5843708794ab2421181043-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab2421181043-4">4</div><div class="crayon-num" data-line="crayon-5843708794ab2421181043-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab2421181043-6">6</div><div class="crayon-num" data-line="crayon-5843708794ab2421181043-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab2421181043-8">8</div><div class="crayon-num" data-line="crayon-5843708794ab2421181043-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab2421181043-10">10</div><div class="crayon-num" data-line="crayon-5843708794ab2421181043-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab2421181043-12">12</div><div class="crayon-num" data-line="crayon-5843708794ab2421181043-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab2421181043-14">14</div><div class="crayon-num" data-line="crayon-5843708794ab2421181043-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab2421181043-16">16</div><div class="crayon-num" data-line="crayon-5843708794ab2421181043-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab2421181043-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5843708794ab2421181043-1"><span class="crayon-c">// our hidden class 'hc_0'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab2421181043-2"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">Vector</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5843708794ab2421181043-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">constructor</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab2421181043-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// compiler finds and expects member declarations here</span></div><div class="crayon-line" id="crayon-5843708794ab2421181043-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab2421181043-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">this</span><span class="crayon-sy">.</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794ab2421181043-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab2421181043-8"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794ab2421181043-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab2421181043-10"><span class="crayon-c">// both vector objects share hidden class 'hc_0'</span></div><div class="crayon-line" id="crayon-5843708794ab2421181043-11"><span class="crayon-e">let </span><span class="crayon-v">vec1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Vector</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab2421181043-12"><span class="crayon-e">let </span><span class="crayon-v">vec2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Vector</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794ab2421181043-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab2421181043-14"><span class="crayon-c">// bad, vec2 got hidden class 'hc_1' now</span></div><div class="crayon-line" id="crayon-5843708794ab2421181043-15"><span class="crayon-v">vec2</span><span class="crayon-sy">.</span><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab2421181043-16">&nbsp;</div><div class="crayon-line" id="crayon-5843708794ab2421181043-17"><span class="crayon-c">// good, compiler knows this member</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab2421181043-18"><span class="crayon-v">vec2</span><span class="crayon-sy">.</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p></p>
<h1 id="articleHeader10">Loops</h1>
<p>尽可能的缓存数组长度的计算值，并且尽可能在同一个数组中存放单个类型。避免使用<code>for-in</code>语法来遍历某个数组，因为它真的很慢。另外，continue与break语句在循环中的性能也是不错的，这一点使用的时候不用担心。另外，尽可能将短小的逻辑部分拆分到独立的函数中，这样更有利于编译器进行优化。另外，使用前缀自增表达式，也能带来小小的性能提升。（++i代替i++）</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5843708794ab5203321218" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">JavaScript</span></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 15px !important; z-index: 0; opacity: 0;">let badarray = [1, true, 0]; // bad, dont mix types
let array = [1, 0, 1]; // happy compiler

// bad choice
for (let key in array) {
  
};

// better
// but always try to cache the array size
let i = 0;
for (; i &lt; array.length; ++i) {
  key = array[i];
};

// good
let i = 0;
let key = null;
let length = array.length;
for (; i &lt; length; ++i) {
  key = array[i];
};</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1;">
				<table class="crayon-table">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5843708794ab5203321218-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab5203321218-2">2</div><div class="crayon-num" data-line="crayon-5843708794ab5203321218-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab5203321218-4">4</div><div class="crayon-num" data-line="crayon-5843708794ab5203321218-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab5203321218-6">6</div><div class="crayon-num" data-line="crayon-5843708794ab5203321218-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab5203321218-8">8</div><div class="crayon-num" data-line="crayon-5843708794ab5203321218-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab5203321218-10">10</div><div class="crayon-num" data-line="crayon-5843708794ab5203321218-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab5203321218-12">12</div><div class="crayon-num" data-line="crayon-5843708794ab5203321218-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab5203321218-14">14</div><div class="crayon-num" data-line="crayon-5843708794ab5203321218-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab5203321218-16">16</div><div class="crayon-num" data-line="crayon-5843708794ab5203321218-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab5203321218-18">18</div><div class="crayon-num" data-line="crayon-5843708794ab5203321218-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab5203321218-20">20</div><div class="crayon-num" data-line="crayon-5843708794ab5203321218-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab5203321218-22">22</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5843708794ab5203321218-1"><span class="crayon-e">let </span><span class="crayon-v">badarray</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// bad, dont mix types</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab5203321218-2"><span class="crayon-e">let </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// happy compiler</span></div><div class="crayon-line" id="crayon-5843708794ab5203321218-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab5203321218-4"><span class="crayon-c">// bad choice</span></div><div class="crayon-line" id="crayon-5843708794ab5203321218-5"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">let </span><span class="crayon-e">key </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab5203321218-6"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5843708794ab5203321218-7"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab5203321218-8">&nbsp;</div><div class="crayon-line" id="crayon-5843708794ab5203321218-9"><span class="crayon-c">// better</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab5203321218-10"><span class="crayon-c">// but always try to cache the array size</span></div><div class="crayon-line" id="crayon-5843708794ab5203321218-11"><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab5203321218-12"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-o">++</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5843708794ab5203321218-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab5203321218-14"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794ab5203321218-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab5203321218-16"><span class="crayon-c">// good</span></div><div class="crayon-line" id="crayon-5843708794ab5203321218-17"><span class="crayon-i">let</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab5203321218-18"><span class="crayon-e">let </span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794ab5203321218-19"><span class="crayon-e">let </span><span class="crayon-r">length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab5203321218-20"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-r">length</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-o">++</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5843708794ab5203321218-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab5203321218-22"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p></p>
<h1 id="articleHeader11">drawImage</h1>
<p>draeImage函数算是最快的2D Canvas API之一了，不过我们需要注意的是如果为了图方便省略了全参数传入，也会增加性能损耗：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->
<div id="crayon-5843708794ab9403598711" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style="margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important; height: auto;">
<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="切换是否显示行编号"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;http://web.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><span class="crayon-language">JavaScript</span></div></div>
<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 13px !important; line-height: 15px !important; z-index: 0; opacity: 0;">// bad
ctx.drawImage(
  img,
  x, y
);

// good
ctx.drawImage(
  img,
  // clipping
  sx, sy,
  sw, sh,
  // actual stuff
  x, y,
  w, h
);

// much hax
// no subpixel rendering by passing integers
ctx.drawImage(
  img,
  sx|0, sy|0,
  sw|0, sh|0,
  x|0, y|0,
  w|0, h|0
);</textarea></div>
<div class="crayon-main" style="position: relative; z-index: 1;">
<table class="crayon-table">
<tbody><tr class="crayon-row">
<td class="crayon-nums " data-settings="show">
<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5843708794ab9403598711-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-2">2</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-4">4</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-6">6</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-8">8</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-10">10</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-12">12</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-14">14</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-16">16</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-18">18</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-20">20</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-22">22</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-24">24</div><div class="crayon-num" data-line="crayon-5843708794ab9403598711-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5843708794ab9403598711-26">26</div></div>
</td>
<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5843708794ab9403598711-1"><span class="crayon-c">// bad</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-2"><span class="crayon-v">ctx</span><span class="crayon-sy">.</span><span class="crayon-e">drawImage</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5843708794ab9403598711-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">img</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line" id="crayon-5843708794ab9403598711-5"><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-6">&nbsp;</div><div class="crayon-line" id="crayon-5843708794ab9403598711-7"><span class="crayon-c">// good</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-8"><span class="crayon-v">ctx</span><span class="crayon-sy">.</span><span class="crayon-e">drawImage</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5843708794ab9403598711-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">img</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// clipping</span></div><div class="crayon-line" id="crayon-5843708794ab9403598711-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sx</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sy</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sw</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sh</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5843708794ab9403598711-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// actual stuff</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5843708794ab9403598711-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">h</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-16"><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5843708794ab9403598711-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-18"><span class="crayon-c">// much hax</span></div><div class="crayon-line" id="crayon-5843708794ab9403598711-19"><span class="crayon-c">// no subpixel rendering by passing integers</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-20"><span class="crayon-v">ctx</span><span class="crayon-sy">.</span><span class="crayon-e">drawImage</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5843708794ab9403598711-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">img</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-22"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sx</span><span class="crayon-o">|</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sy</span><span class="crayon-o">|</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5843708794ab9403598711-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sw</span><span class="crayon-o">|</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sh</span><span class="crayon-o">|</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-o">|</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">|</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5843708794ab9403598711-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">w</span><span class="crayon-o">|</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-o">|</span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5843708794ab9403598711-26"><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
</tr>
</tbody></table>
</div>
</div>
